# MentorX MVP è®¡åˆ’ï¼šé¡¾é—®çº¦è¯¾åŠè‡ªåŠ¨è®¡è´¹ç³»ç»Ÿ

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

- **é¡¹ç›®**: MentorX Platform MVP
- **ç‰ˆæœ¬**: v2.0
- **ç›®æ ‡**: å®ç°é¡¾é—®ä¸ºå­¦ç”Ÿé¢„çº¦å¯¼å¸ˆè¯¾ç¨‹åŠè‡ªåŠ¨è®¡è´¹çš„æ ¸å¿ƒæµç¨‹

---

## ğŸ¯ MVP èŒƒå›´å®šä¹‰

### æ ¸å¿ƒåŠŸèƒ½ï¼ˆMust Haveï¼‰

```
1. ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
   - å­¦ç”Ÿæ³¨å†Œ/ç™»å½•
   - å¯¼å¸ˆæ³¨å†Œ/ç™»å½•
   - é¡¾é—®æ³¨å†Œ/ç™»å½• â­

2. å¯¼å¸ˆæ¡£æ¡ˆç®¡ç†
   - å¯¼å¸ˆåˆ›å»ºä¸ªäººæ¡£æ¡ˆ
   - å¯¼å¸ˆè®¾ç½®æœåŠ¡è´¹ç‡

3. å­¦ç”Ÿ-é¡¾é—®å…³ç³»ç®¡ç† â­
   - ä¸ºå­¦ç”Ÿåˆ†é…é¡¾é—®
   - é¡¾é—®æŸ¥çœ‹è‡ªå·±ç®¡ç†çš„å­¦ç”Ÿ

4. å­¦ç”Ÿè´­ä¹°æœåŠ¡
   - åˆ›å»ºæœåŠ¡åˆåŒï¼ˆç”±é¡¾é—®æˆ–ç®¡ç†å‘˜æ“ä½œï¼‰
   - å­¦ç”Ÿè·å¾—è¯¾æ—¶é¢åº¦

5. é¡¾é—®é¢„çº¦è¯¾ç¨‹ â­â­â­
   - é¡¾é—®æŸ¥çœ‹å­¦ç”Ÿçš„å‰©ä½™è¯¾æ—¶
   - é¡¾é—®æŸ¥çœ‹å¯¼å¸ˆå¯ç”¨æ—¶é—´å’Œè´¹ç‡
   - é¡¾é—®ä¸ºå­¦ç”Ÿé¢„çº¦è¯¾ç¨‹
   - é¡¾é—®æŸ¥çœ‹å­¦ç”Ÿçš„é¢„çº¦è®°å½•

6. è¯¾ç¨‹å®Œæˆå’Œè®¡è´¹ â­â­â­
   - å¯¼å¸ˆæ ‡è®°è¯¾ç¨‹å®Œæˆ
   - ç³»ç»Ÿè‡ªåŠ¨æ‰£å‡å­¦ç”Ÿè¯¾æ—¶
   - ç³»ç»Ÿè‡ªåŠ¨è®°å½•å¯¼å¸ˆåº”å¾—æŠ¥é…¬
```

### ä¸åœ¨ MVP èŒƒå›´ï¼ˆFutureï¼‰

```
âŒ å­¦ç”Ÿè‡ªä¸»é¢„çº¦åŠŸèƒ½
âŒ å¤æ‚çš„æ”¯ä»˜é›†æˆ
âŒ ç»“ç®—å’Œæ‰“æ¬¾æµç¨‹
âŒ é€šçŸ¥ç³»ç»Ÿï¼ˆé‚®ä»¶/çŸ­ä¿¡ï¼‰
âŒ æ—¥ç¨‹æé†’
âŒ è§†é¢‘ä¼šè®®é›†æˆï¼ˆå…ˆç”¨æ‰‹åŠ¨åˆ†äº«é“¾æ¥ï¼‰
âŒ è¯„ä»·å’Œåé¦ˆç³»ç»Ÿ
âŒ å¤æ‚çš„æŠ¥è¡¨å’Œåˆ†æ
âŒ Admin ç®¡ç†åå°
âŒ ç§»åŠ¨ç«¯
```

---

## ğŸ“ æœ€å°åŒ–ç›®å½•ç»“æ„

### æ ¸å¿ƒç›®å½•å±‚æ¬¡è¯´æ˜

```
mentorx-mvp/
â”œâ”€â”€ src/
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                              # API å±‚ï¼ˆå¤–éƒ¨æ¥å£ï¼‰
â”‚   â”‚   â”‚                                 # èŒè´£ï¼šæ¥æ”¶HTTPè¯·æ±‚ï¼Œè¿”å›HTTPå“åº”
â”‚   â”‚   â”‚                                 # ç‰¹ç‚¹ï¼šè–„å±‚ï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ controllers/                  # RESTful æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼š
â”‚   â”‚   â”‚   â”‚                             # - è·¯ç”±å®šä¹‰å’Œå‚æ•°æå–
â”‚   â”‚   â”‚   â”‚                             # - è°ƒç”¨ Application Service
â”‚   â”‚   â”‚   â”‚                             # - ç»„è£…å‰ç«¯éœ€è¦çš„å“åº”æ•°æ®
â”‚   â”‚   â”‚   â”‚                             # åŒ…å«ï¼šauth, profile, contract, booking ç­‰æ§åˆ¶å™¨
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ dto/                          # æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆData Transfer Objectsï¼‰
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼šå®šä¹‰ API çš„è¾“å…¥è¾“å‡ºå¥‘çº¦
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ request/                  # è¯·æ±‚ DTO
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼šå®šä¹‰å’ŒéªŒè¯å‰ç«¯å‘é€çš„æ•°æ®æ ¼å¼
â”‚   â”‚   â”‚   â”‚                             # åŒ…å«ï¼šæ³¨å†Œã€ç™»å½•ã€åˆ›å»ºé¢„çº¦ã€å®Œæˆè¯¾ç¨‹ç­‰è¯·æ±‚æ ¼å¼
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ response/                 # å“åº” DTO â­
â”‚   â”‚   â”‚                                 # èŒè´£ï¼šå®šä¹‰è¿”å›ç»™å‰ç«¯çš„æ•°æ®ç»“æ„
â”‚   â”‚   â”‚                                 # ç‰¹ç‚¹ï¼šé’ˆå¯¹å‰ç«¯ä¼˜åŒ–ï¼ŒåŒ…å«å…³è”æ•°æ®ã€è®¡ç®—å­—æ®µ
â”‚   â”‚   â”‚                                 # åŒ…å«ï¼šé¢„çº¦è¯¦æƒ…ã€ä½™é¢ä¿¡æ¯ã€çœ‹æ¿æ•°æ®ç­‰
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ transformers/                 # æ•°æ®è½¬æ¢å™¨ â­
â”‚   â”‚                                     # èŒè´£ï¼š
â”‚   â”‚                                     # - å°†é¢†åŸŸå¯¹è±¡è½¬æ¢ä¸º Response DTO
â”‚   â”‚                                     # - ç»„è£…å¤šä¸ªé¢†åŸŸå¯¹è±¡çš„æ•°æ®
â”‚   â”‚                                     # - æ·»åŠ å‰ç«¯éœ€è¦çš„è®¡ç®—å­—æ®µå’Œæç¤ºä¿¡æ¯
â”‚   â”‚                                     # åŒ…å«ï¼šbooking, profile, contract ç­‰è½¬æ¢å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ application/                      # åº”ç”¨æœåŠ¡å±‚ â­â­â­ï¼ˆæ ¸å¿ƒä¸šåŠ¡åè°ƒå±‚ï¼‰
â”‚   â”‚   â”‚                                 # èŒè´£ï¼šå®ç°å…·ä½“çš„ä¸šåŠ¡ç”¨ä¾‹ï¼ˆUse Caseï¼‰
â”‚   â”‚   â”‚                                 # ç‰¹ç‚¹ï¼šæ— çŠ¶æ€ã€å¯å¤ç”¨ã€äº‹åŠ¡ç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ queries/                      # æŸ¥è¯¢æœåŠ¡ï¼ˆCQRS - Read Sideï¼‰
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼š
â”‚   â”‚   â”‚   â”‚                             # - è·¨åŸŸæ•°æ®æŸ¥è¯¢å’Œèšåˆ
â”‚   â”‚   â”‚   â”‚                             # - æ€§èƒ½ä¼˜åŒ–ï¼ˆå¹¶è¡ŒæŸ¥è¯¢ã€JOINï¼‰
â”‚   â”‚   â”‚   â”‚                             # - è¿”å›é¢†åŸŸå¯¹è±¡æˆ–ç®€å• DTO
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”‚                             # åŒ…å«çš„æŸ¥è¯¢æœåŠ¡ï¼š
â”‚   â”‚   â”‚   â”œâ”€â”€ profile-query/            # æ¡£æ¡ˆæŸ¥è¯¢ï¼ˆå­¦ç”Ÿã€å¯¼å¸ˆã€é¡¾é—®ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ availability-query/       # å¯ç”¨æ€§æŸ¥è¯¢ â­
â”‚   â”‚   â”‚   â”‚                             # - å­¦ç”Ÿä½™é¢æŸ¥è¯¢
â”‚   â”‚   â”‚   â”‚                             # - å¯¼å¸ˆæ—¥ç¨‹æŸ¥è¯¢
â”‚   â”‚   â”‚   â”‚                             # - æ—¶é—´å†²çªæ£€æµ‹
â”‚   â”‚   â”‚   â”œâ”€â”€ pricing-query/            # å®šä»·æŸ¥è¯¢ â­
â”‚   â”‚   â”‚   â”‚                             # - æœåŠ¡è´¹ç‡æŸ¥è¯¢
â”‚   â”‚   â”‚   â”‚                             # - è´¹ç”¨è®¡ç®—
â”‚   â”‚   â”‚   â”œâ”€â”€ balance-query/            # ä½™é¢æŸ¥è¯¢ â­
â”‚   â”‚   â”‚   â”‚                             # - åˆåŒä½™é¢è®¡ç®—
â”‚   â”‚   â”‚   â”‚                             # - æ¶ˆè´¹å†å²èšåˆ
â”‚   â”‚   â”‚   â””â”€â”€ counselor-query/          # é¡¾é—®æŸ¥è¯¢ â­
â”‚   â”‚   â”‚                                 # - é¡¾é—®çš„å­¦ç”Ÿåˆ—è¡¨
â”‚   â”‚   â”‚                                 # - å­¦ç”Ÿé¢„çº¦ç»Ÿè®¡
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ commands/                     # å‘½ä»¤æœåŠ¡ï¼ˆCQRS - Write Sideï¼‰
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼š
â”‚   â”‚   â”‚   â”‚                             # - æ‰§è¡Œå†™æ“ä½œï¼ˆåˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ï¼‰
â”‚   â”‚   â”‚   â”‚                             # - è°ƒç”¨é¢†åŸŸæ¨¡å‹éªŒè¯ä¸šåŠ¡è§„åˆ™
â”‚   â”‚   â”‚   â”‚                             # - äº‹åŠ¡ç®¡ç†
â”‚   â”‚   â”‚   â”‚                             # - å‘å¸ƒé¢†åŸŸäº‹ä»¶
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”‚                             # åŒ…å«çš„å‘½ä»¤æœåŠ¡ï¼š
â”‚   â”‚   â”‚   â”œâ”€â”€ auth-command/             # è®¤è¯å‘½ä»¤ï¼ˆæ³¨å†Œã€ç™»å½•ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ profile-command/          # æ¡£æ¡ˆå‘½ä»¤ï¼ˆåˆ›å»ºã€æ›´æ–°æ¡£æ¡ˆï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ contract-command/         # åˆåŒå‘½ä»¤ï¼ˆåˆ›å»ºåˆåŒã€åˆ†é…æƒç›Šï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ assignment-command/       # åˆ†é…å‘½ä»¤ï¼ˆå­¦ç”Ÿ-é¡¾é—®å…³ç³»ï¼‰ â­
â”‚   â”‚   â”‚   â”œâ”€â”€ session-command/          # ä¼šè¯å‘½ä»¤ â­
â”‚   â”‚   â”‚   â”‚                             # - åˆ›å»ºé¢„çº¦
â”‚   â”‚   â”‚   â”‚                             # - å®Œæˆè¯¾ç¨‹
â”‚   â”‚   â”‚   â”‚                             # - å–æ¶ˆé¢„çº¦
â”‚   â”‚   â”‚   â””â”€â”€ hold-command/             # é¢„å å‘½ä»¤ â­
â”‚   â”‚   â”‚                                 # - åˆ›å»ºæœåŠ¡é¢„å 
â”‚   â”‚   â”‚                                 # - é‡Šæ”¾é¢„å 
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ sagas/                        # ç¼–æ’æœåŠ¡ï¼ˆè·¨åŸŸåè°ƒï¼‰â­â­â­
â”‚   â”‚                                     # èŒè´£ï¼š
â”‚   â”‚                                     # - åè°ƒå¤šä¸ªå‘½ä»¤æœåŠ¡
â”‚   â”‚                                     # - ç®¡ç†è·¨åŸŸäº‹åŠ¡
â”‚   â”‚                                     # - å¤„ç†å¤±è´¥å’Œè¡¥å¿
â”‚   â”‚                                     # 
â”‚   â”‚                                     # æ ¸å¿ƒ Sagaï¼š
â”‚   â”‚                                     # - booking.saga: é¢„çº¦æµç¨‹åè°ƒ
â”‚   â”‚                                     # - completion.saga: å®Œæˆè®¡è´¹æµç¨‹åè°ƒ
â”‚   â”‚
â”‚   â”œâ”€â”€ domains/                          # é¢†åŸŸå±‚ï¼ˆä¸šåŠ¡è§„åˆ™æ ¸å¿ƒï¼‰
â”‚   â”‚   â”‚                                 # èŒè´£ï¼šå°è£…ä¸šåŠ¡è§„åˆ™å’Œé¢†åŸŸé€»è¾‘
â”‚   â”‚   â”‚                                 # ç‰¹ç‚¹ï¼šçº¯ç²¹çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¸ä¾èµ–å¤–éƒ¨
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ identity/                     # èº«ä»½åŸŸ
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼šç”¨æˆ·èº«ä»½ç®¡ç†å’Œè®¤è¯
â”‚   â”‚   â”‚   â”‚ åŒ…å«ï¼šUser å®ä½“ã€è§’è‰²ç®¡ç†ã€è®¤è¯æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ user/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ profile/                      # æ¡£æ¡ˆåŸŸ
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼šç®¡ç†ä¸åŒè§’è‰²çš„è¯¦ç»†æ¡£æ¡ˆä¿¡æ¯
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ student/                  # å­¦ç”Ÿæ¡£æ¡ˆ
â”‚   â”‚   â”‚   â”‚                             # åŒ…å«ï¼šå­¦æ ¡ã€ä¸“ä¸šã€æˆç»©ã€ç›®æ ‡ç­‰
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ mentor/                   # å¯¼å¸ˆæ¡£æ¡ˆ
â”‚   â”‚   â”‚   â”‚                             # åŒ…å«ï¼šå…¬å¸ã€èŒä½ã€ç»éªŒã€ä¸“é•¿ç­‰
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ counselor/                # é¡¾é—®æ¡£æ¡ˆ
â”‚   â”‚   â”‚                                 # åŒ…å«ï¼šä¸“é•¿é¢†åŸŸã€æœåŠ¡åŒºåŸŸç­‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ people/                       # äººå‘˜å…³ç³»åŸŸ â­
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼šç®¡ç†äººä¸äººä¹‹é—´çš„å…³ç³»
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ counselor-assignment/     # é¡¾é—®-å­¦ç”Ÿåˆ†é…å…³ç³» â­
â”‚   â”‚   â”‚                                 # å®ä½“ï¼šCounselorAssignment
â”‚   â”‚   â”‚                                 # ä¸šåŠ¡è§„åˆ™ï¼š
â”‚   â”‚   â”‚                                 # - ä¸€ä¸ªå­¦ç”Ÿåªèƒ½æœ‰ä¸€ä¸ªæ´»è·ƒé¡¾é—®
â”‚   â”‚   â”‚                                 # - é¡¾é—®è´Ÿè½½é™åˆ¶
â”‚   â”‚   â”‚                                 # - åˆ†é…å†å²è®°å½•
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ service-provider/             # æœåŠ¡æä¾›è€…åŸŸ
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼šç®¡ç†æœåŠ¡æä¾›è€…å’Œå®šä»·
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ provider/                 # æä¾›è€…ç®¡ç†
â”‚   â”‚   â”‚   â”‚                             # å®ä½“ï¼šServiceProviderï¼ˆå†…éƒ¨å¯¼å¸ˆï¼‰
â”‚   â”‚   â”‚   â”‚                             # ä¸šåŠ¡è§„åˆ™ï¼šæä¾›è€…çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ rate/                     # è´¹ç‡ç®¡ç† â­
â”‚   â”‚   â”‚                                 # å®ä½“ï¼šServiceRate
â”‚   â”‚   â”‚                                 # ä¸šåŠ¡è§„åˆ™ï¼š
â”‚   â”‚   â”‚                                 # - è´¹ç‡ç”Ÿæ•ˆæ—¶é—´
â”‚   â”‚   â”‚                                 # - è´¹ç‡ç±»å‹ï¼ˆæ—¶è–ª/å›ºå®šï¼‰
â”‚   â”‚   â”‚                                 # - å†å²è´¹ç‡è¿½æº¯
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ catalog/                      # æœåŠ¡ç›®å½•åŸŸï¼ˆç®€åŒ–ï¼‰
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼šå®šä¹‰å¯æä¾›çš„æœåŠ¡ç±»å‹
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ service/                  # æœåŠ¡å®šä¹‰
â”‚   â”‚   â”‚                                 # å®ä½“ï¼šServiceï¼ˆ1å¯¹1è¾…å¯¼ã€ç®€å†ä¿®æ”¹ç­‰ï¼‰
â”‚   â”‚   â”‚                                 # å±æ€§ï¼šåç§°ã€ç±»å‹ã€è®¡é‡å•ä½
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ contract/                     # åˆåŒåŸŸ â­â­â­ï¼ˆæ ¸å¿ƒåŸŸï¼‰
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼šç®¡ç†æœåŠ¡æƒç›Šå’Œæ¶ˆè´¹
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ contract/                 # åˆåŒå’Œæƒç›Š
â”‚   â”‚   â”‚   â”‚                             # å®ä½“ï¼šContractï¼ˆåˆåŒä¸»è¡¨ï¼‰
â”‚   â”‚   â”‚   â”‚                             # å®ä½“ï¼šContractEntitlementï¼ˆæœåŠ¡æƒç›Šæ˜ç»†ï¼‰â­
â”‚   â”‚   â”‚   â”‚                             # ä¸šåŠ¡è§„åˆ™ï¼š
â”‚   â”‚   â”‚   â”‚                             # - æƒç›Šåˆ†é…å’Œæ¶ˆè´¹
â”‚   â”‚   â”‚   â”‚                             # - ä½™é¢è®¡ç®—
â”‚   â”‚   â”‚   â”‚                             # - åˆåŒçŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ service-ledger/           # æœåŠ¡æµæ°´ â­â­â­ï¼ˆå”¯ä¸€äº‹å®æ¥æºï¼‰
â”‚   â”‚   â”‚   â”‚                             # å®ä½“ï¼šServiceLedger
â”‚   â”‚   â”‚   â”‚                             # ç‰¹ç‚¹ï¼šåªèƒ½ INSERTï¼Œä¸èƒ½ UPDATE/DELETE
â”‚   â”‚   â”‚   â”‚                             # ä¸šåŠ¡è§„åˆ™ï¼š
â”‚   â”‚   â”‚   â”‚                             # - è®°å½•æ¯æ¬¡æœåŠ¡æ¶ˆè´¹
â”‚   â”‚   â”‚   â”‚                             # - æ”¯æŒè°ƒæ•´è®°å½•ï¼ˆè´Ÿæ•°ï¼‰
â”‚   â”‚   â”‚   â”‚                             # - å®Œæ•´å®¡è®¡è½¨è¿¹
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ service-hold/             # æœåŠ¡é¢„å  â­
â”‚   â”‚   â”‚                                 # å®ä½“ï¼šServiceHold
â”‚   â”‚   â”‚                                 # ä¸šåŠ¡è§„åˆ™ï¼š
â”‚   â”‚   â”‚                                 # - é¢„çº¦æ—¶åˆ›å»ºï¼Œå®Œæˆæ—¶é‡Šæ”¾
â”‚   â”‚   â”‚                                 # - TTL è¿‡æœŸæœºåˆ¶
â”‚   â”‚   â”‚                                 # - é˜²æ­¢è¶…é¢é¢„çº¦
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ services/                     # æœåŠ¡äº¤ä»˜åŸŸ â­â­â­ï¼ˆæ ¸å¿ƒåŸŸï¼‰
â”‚   â”‚   â”‚   â”‚                             # èŒè´£ï¼šç®¡ç†å®é™…çš„æœåŠ¡äº¤ä»˜è®°å½•
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ session/                  # è¾…å¯¼ä¼šè¯ â­
â”‚   â”‚   â”‚                                 # å®ä½“ï¼šSessionï¼ˆé¢„çº¦è®°å½•ï¼‰
â”‚   â”‚   â”‚                                 # ä¸šåŠ¡è§„åˆ™ï¼š
â”‚   â”‚   â”‚                                 # - é¢„çº¦åˆ›å»ºå’ŒçŠ¶æ€è½¬æ¢
â”‚   â”‚   â”‚                                 # - æ—¶é—´å†²çªæ£€æµ‹
â”‚   â”‚   â”‚                                 # - å®Œæˆæ¡ä»¶éªŒè¯
â”‚   â”‚   â”‚                                 # - ä¼šè®®ä¿¡æ¯ç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ finance/                      # è´¢åŠ¡åŸŸ â­â­
â”‚   â”‚       â”‚                             # èŒè´£ï¼šç®¡ç†è´¢åŠ¡æ ¸ç®—
â”‚   â”‚       â”‚
â”‚   â”‚       â””â”€â”€ ap-ledger/                # åº”ä»˜è´¦æ¬¾æµæ°´ â­
â”‚   â”‚                                     # å®ä½“ï¼šAPLedger
â”‚   â”‚                                     # ç‰¹ç‚¹ï¼šåªèƒ½ INSERTï¼Œä¸èƒ½ UPDATE/DELETE
â”‚   â”‚                                     # ä¸šåŠ¡è§„åˆ™ï¼š
â”‚   â”‚                                     # - è®°å½•å¯¼å¸ˆåº”å¾—æŠ¥é…¬
â”‚   â”‚                                     # - æ”¯æŒç»“ç®—å¯¹è´¦
â”‚   â”‚                                     # - å®Œæ•´å®¡è®¡è½¨è¿¹
â”‚   â”‚
â”‚   â”œâ”€â”€ infrastructure/                   # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â”‚                                 # èŒè´£ï¼šæä¾›æŠ€æœ¯åŸºç¡€è®¾æ–½æ”¯æŒ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ database/                     # æ•°æ®åº“é…ç½®
â”‚   â”‚   â”‚                                 # - ORM é…ç½®ï¼ˆDrizzleï¼‰
â”‚   â”‚   â”‚                                 # - è¿æ¥æ± ç®¡ç†
â”‚   â”‚   â”‚                                 # - æ•°æ®åº“è¿ç§»
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ events/                       # äº‹ä»¶æ€»çº¿ï¼ˆç®€åŒ–ç‰ˆï¼‰
â”‚   â”‚                                     # èŒè´£ï¼š
â”‚   â”‚                                     # - é¢†åŸŸäº‹ä»¶å‘å¸ƒ
â”‚   â”‚                                     # - äº‹ä»¶å¤„ç†å™¨æ³¨å†Œ
â”‚   â”‚                                     # - å¼‚æ­¥äº‹ä»¶å¤„ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ shared/                           # å…±äº«æ¨¡å—
â”‚   â”‚   â”‚                                 # èŒè´£ï¼šæä¾›è·¨æ¨¡å—çš„é€šç”¨åŠŸèƒ½
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ types/                        # å…±äº«ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ utils/                        # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ constants/                    # å¸¸é‡å®šä¹‰
â”‚   â”‚   â””â”€â”€ guards/                       # å®ˆå«ï¼ˆè®¤è¯ã€æƒé™ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ main.ts                           # åº”ç”¨å…¥å£
â”‚
â”œâ”€â”€ drizzle/                              # æ•°æ®åº“å±‚
â”‚   â”‚                                     # èŒè´£ï¼šæ•°æ®åº“ Schema å®šä¹‰å’Œè¿ç§»
â”‚   â”‚
â”‚   â”œâ”€â”€ schema/                           # Schema å®šä¹‰æ–‡ä»¶
â”‚   â”‚   â”‚                                 # æŒ‰åŸŸç»„ç»‡ï¼š
â”‚   â”‚   â”‚                                 # - users.schema: ç”¨æˆ·å’Œè§’è‰²è¡¨
â”‚   â”‚   â”‚                                 # - profiles.schema: æ¡£æ¡ˆè¡¨
â”‚   â”‚   â”‚                                 # - people.schema: äººå‘˜å…³ç³»è¡¨ â­
â”‚   â”‚   â”‚                                 # - service-providers.schema: æä¾›è€…å’Œè´¹ç‡è¡¨
â”‚   â”‚   â”‚                                 # - contracts.schema: åˆåŒã€æƒç›Šã€æµæ°´è¡¨ â­
â”‚   â”‚   â”‚                                 # - sessions.schema: é¢„çº¦è®°å½•è¡¨ â­
â”‚   â”‚   â”‚                                 # - finance.schema: è´¢åŠ¡æµæ°´è¡¨ â­
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ migrations/                   # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”‚   â”‚                                     # è‡ªåŠ¨ç”Ÿæˆçš„è¿ç§» SQL
â”‚
â”œâ”€â”€ .env.example                          # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ package.json                          # ä¾èµ–ç®¡ç†
â””â”€â”€ tsconfig.json                         # TypeScript é…ç½®
```

### ğŸ“Š ç›®å½•èŒè´£æ€»ç»“

| å±‚æ¬¡ | èŒè´£ | ç‰¹ç‚¹ | æ ¸å¿ƒå…³æ³¨ |
|-----|------|------|---------|
| **API** | æ¥æ”¶å’Œå“åº”HTTPè¯·æ±‚ | è–„å±‚ï¼Œä¸å«ä¸šåŠ¡é€»è¾‘ | å‰ç«¯æ¥å£å¥‘çº¦ |
| **Application** | å®ç°ä¸šåŠ¡ç”¨ä¾‹ | æ— çŠ¶æ€ï¼Œå¯å¤ç”¨ | ä¸šåŠ¡æµç¨‹ç¼–æ’ |
| **Domain** | å°è£…ä¸šåŠ¡è§„åˆ™ | çº¯ç²¹çš„é¢†åŸŸé€»è¾‘ | ä¸šåŠ¡è§„åˆ™éªŒè¯ |
| **Infrastructure** | æŠ€æœ¯åŸºç¡€è®¾æ–½ | å¯æ›¿æ¢å®ç° | æŠ€æœ¯ç»†èŠ‚éš”ç¦» |

---

## ğŸ”„ æ ¸å¿ƒæµç¨‹è®¾è®¡

### æµç¨‹ 1: å¯¼å¸ˆå‡†å¤‡å·¥ä½œ

```
æ­¥éª¤ 1: å¯¼å¸ˆæ³¨å†Œ
POST /api/auth/register
  â†“
Identity Domain: åˆ›å»º User
  â†“
è¿”å›: { userId, token }

æ­¥éª¤ 2: å¯¼å¸ˆå®Œå–„æ¡£æ¡ˆ
POST /api/profiles/mentor
  â†“
Profile Domain: åˆ›å»º MentorProfile
  â†“
Service Provider Domain: è‡ªåŠ¨åˆ›å»º ServiceProvider
  â†“
è¿”å›: { profileId, providerId }

æ­¥éª¤ 3: å¯¼å¸ˆè®¾ç½®è´¹ç‡
POST /api/profiles/mentor/rates
Body: {
  serviceId: "uuid",
  rateType: "hourly",
  baseRate: 100,
  currency: "USD"
}
  â†“
Service Provider Domain: åˆ›å»º ServiceRate
  â†“
è¿”å›: { rateId, baseRate }

æ­¥éª¤ 4: å¯¼å¸ˆè®¾ç½®å¯ç”¨æ—¶é—´ï¼ˆç®€åŒ–ï¼šæ‰‹åŠ¨åè°ƒï¼‰
ï¼ˆMVP é˜¶æ®µå¯ä»¥è·³è¿‡å¤æ‚çš„æ—¥ç¨‹ç®¡ç†ï¼‰
```

---

### æµç¨‹ 2: å­¦ç”Ÿå‡†å¤‡å·¥ä½œ

```
æ­¥éª¤ 1: å­¦ç”Ÿæ³¨å†Œ
POST /api/auth/register
  â†“
Identity Domain: åˆ›å»º User
  â†“
è¿”å›: { userId, token }

æ­¥éª¤ 2: å­¦ç”Ÿå®Œå–„æ¡£æ¡ˆï¼ˆå¯é€‰ï¼‰
POST /api/profiles/student
  â†“
Profile Domain: åˆ›å»º StudentProfile
  â†“
è¿”å›: { profileId }

æ­¥éª¤ 3: å­¦ç”Ÿè´­ä¹°æœåŠ¡å¥—é¤
POST /api/contracts
Body: {
  studentId: "uuid",
  services: [
    {
      serviceId: "session-service-uuid",
      quantity: 10,    // è´­ä¹°10å°æ—¶
      unitPrice: 100
    }
  ],
  totalAmount: 1000
}
  â†“
Contract Domain: åˆ›å»º Contract + ContractEntitlement
  â†“
è¿”å›: { 
  contractId, 
  entitlements: [
    {
      serviceId,
      allocated: 10,
      remaining: 10
    }
  ]
}

æ³¨ï¼šMVPé˜¶æ®µæ”¯ä»˜å¯ä»¥æ ‡è®°ä¸º"å·²æ”¯ä»˜"ï¼Œä¸åšçœŸå®æ”¯ä»˜é›†æˆ
```

---

### æµç¨‹ 3: å­¦ç”Ÿé¢„çº¦è¯¾ç¨‹ â­â­â­ï¼ˆæ ¸å¿ƒæµç¨‹ï¼‰

#### é˜¶æ®µ 1: æŸ¥çœ‹é¢„çº¦å‰ç½®ä¿¡æ¯

```
è¯·æ±‚:
GET /api/bookings/prerequisites?mentorId=xxx&serviceId=xxx&date=2025-11-10

è°ƒç”¨é“¾:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BookingController.getPrerequisites()                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¹¶è¡ŒæŸ¥è¯¢ä¸‰ä¸ª Query Service:                             â”‚
â”‚                                                         â”‚
â”‚  1. AvailabilityQueryService.getStudentBalance()        â”‚
â”‚     â†“                                                   â”‚
â”‚     æŸ¥è¯¢ Contract Domain:                               â”‚
â”‚     - contractEntitlements è¡¨ï¼ˆåˆ†é…é‡ï¼‰                 â”‚
â”‚     - serviceLedgers è¡¨ï¼ˆå·²æ¶ˆè´¹ï¼‰                       â”‚
â”‚     - serviceHolds è¡¨ï¼ˆå·²é¢„å ï¼‰                         â”‚
â”‚     â†“                                                   â”‚
â”‚     è®¡ç®—: available = allocated - consumed - held       â”‚
â”‚     â†“                                                   â”‚
â”‚     è¿”å›: {                                             â”‚
â”‚       allocated: 10,                                    â”‚
â”‚       consumed: 3,                                      â”‚
â”‚       held: 2,                                          â”‚
â”‚       available: 5                                      â”‚
â”‚     }                                                   â”‚
â”‚                                                         â”‚
â”‚  2. AvailabilityQueryService.getMentorSchedule()        â”‚
â”‚     â†“                                                   â”‚
â”‚     æŸ¥è¯¢ Services Domain:                               â”‚
â”‚     - sessions è¡¨ï¼ˆæŸ¥è¯¢å¯¼å¸ˆåœ¨æŒ‡å®šæ—¥æœŸçš„é¢„çº¦ï¼‰          â”‚
â”‚     â†“                                                   â”‚
â”‚     è®¡ç®—å¯ç”¨æ—¶é—´æ®µ                                      â”‚
â”‚     â†“                                                   â”‚
â”‚     è¿”å›: {                                             â”‚
â”‚       date: "2025-11-10",                              â”‚
â”‚       busySlots: [                                     â”‚
â”‚         { start: "09:00", end: "10:00" },             â”‚
â”‚         { start: "14:00", end: "15:00" }              â”‚
â”‚       ],                                               â”‚
â”‚       availableSlots: [                                â”‚
â”‚         { start: "10:00", end: "12:00" },             â”‚
â”‚         { start: "15:00", end: "18:00" }              â”‚
â”‚       ]                                                â”‚
â”‚     }                                                  â”‚
â”‚                                                         â”‚
â”‚  3. PricingQueryService.getServiceCost()                â”‚
â”‚     â†“                                                   â”‚
â”‚     æŸ¥è¯¢ Service Provider Domain:                       â”‚
â”‚     - serviceRates è¡¨ï¼ˆæŸ¥è¯¢å¯¼å¸ˆå¯¹è¯¥æœåŠ¡çš„è´¹ç‡ï¼‰        â”‚
â”‚     â†“                                                   â”‚
â”‚     è®¡ç®—: totalCost = baseRate Ã— duration               â”‚
â”‚     â†“                                                   â”‚
â”‚     è¿”å›: {                                             â”‚
â”‚       baseRate: 100,                                    â”‚
â”‚       duration: 1,                                      â”‚
â”‚       totalCost: 100,                                   â”‚
â”‚       currency: "USD"                                   â”‚
â”‚     }                                                   â”‚
â”‚                                                         â”‚
â”‚  BookingTransformer.toPrerequisitesDto()                â”‚
â”‚  â†“                                                      â”‚
â”‚  ç»„è£…æ‰€æœ‰æ•°æ®è¿”å›å‰ç«¯                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¿”å›ç»™å‰ç«¯:
{
  balance: {
    allocated: 10,
    consumed: 3,
    held: 2,
    available: 5,
    canBook: true
  },
  schedule: {
    date: "2025-11-10",
    availableSlots: [...]
  },
  pricing: {
    baseRate: 100,
    totalCost: 100,
    currency: "USD"
  },
  mentor: {
    id: "uuid",
    name: "Jane Smith",
    avatar: "https://...",
    company: "Google"
  }
}
```

#### é˜¶æ®µ 2: åˆ›å»ºé¢„çº¦

```
è¯·æ±‚:
POST /api/bookings
Body: {
  mentorId: "uuid",
  serviceId: "uuid",
  scheduledAt: "2025-11-10T14:00:00Z",
  duration: 1,
  notes: "å‡†å¤‡è®¨è®ºç®€å†ä¿®æ”¹"
}

è°ƒç”¨é“¾:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BookingController.createBooking()                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  è°ƒç”¨ BookingSaga.execute()  â­â­â­                      â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BookingSaga.execute()                                  â”‚
â”‚  (Application Layer)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ã€å¼€å§‹æ•°æ®åº“äº‹åŠ¡ã€‘                                      â”‚
â”‚                                                         â”‚
â”‚  Step 1: éªŒè¯å‰ç½®æ¡ä»¶ï¼ˆå¿«é€Ÿå¤±è´¥ï¼‰                        â”‚
â”‚    â”œâ”€ éªŒè¯ä½™é¢æ˜¯å¦å……è¶³                                  â”‚
â”‚    â”œâ”€ éªŒè¯æ—¶é—´æ˜¯å¦å†²çª                                  â”‚
â”‚    â””â”€ éªŒè¯å¯¼å¸ˆè´¹ç‡æ˜¯å¦å­˜åœ¨                              â”‚
â”‚                                                         â”‚
â”‚  Step 2: åˆ›å»ºæœåŠ¡é¢„å  â­                                â”‚
â”‚    â†“                                                    â”‚
â”‚    HoldCommandService.createHold()                      â”‚
â”‚    â†“                                                    â”‚
â”‚    Contract Domain:                                     â”‚
â”‚      - åŠ è½½ Contract + ContractEntitlement              â”‚
â”‚      - è°ƒç”¨é¢†åŸŸæ–¹æ³•: contract.createServiceHold()       â”‚
â”‚      - éªŒè¯ä½™é¢è§„åˆ™                                     â”‚
â”‚      - åˆ›å»º ServiceHold è®°å½•                            â”‚
â”‚        {                                                â”‚
â”‚          contractId: "uuid",                            â”‚
â”‚          serviceId: "uuid",                             â”‚
â”‚          quantity: 1,                                   â”‚
â”‚          status: "active",                              â”‚
â”‚          holdUntil: now + 30åˆ†é’Ÿ                        â”‚
â”‚        }                                                â”‚
â”‚      - ä¿å­˜åˆ° service_holds è¡¨                          â”‚
â”‚    â†“                                                    â”‚
â”‚    è¿”å›: holdId                                         â”‚
â”‚                                                         â”‚
â”‚  Step 3: åˆ›å»º Session è®°å½• â­                           â”‚
â”‚    â†“                                                    â”‚
â”‚    SessionCommandService.createSession()                â”‚
â”‚    â†“                                                    â”‚
â”‚    Services Domain:                                     â”‚
â”‚      - åˆ›å»º Session å®ä½“                                â”‚
â”‚        {                                                â”‚
â”‚          studentId: "uuid",                             â”‚
â”‚          mentorId: "uuid",                              â”‚
â”‚          contractId: "uuid",                            â”‚
â”‚          serviceId: "uuid",                             â”‚
â”‚          holdId: "uuid",  // å…³è”é¢„å                    â”‚
â”‚          scheduledAt: "2025-11-10T14:00:00Z",         â”‚
â”‚          duration: 1,                                   â”‚
â”‚          status: "scheduled",                           â”‚
â”‚          estimatedCost: 100                             â”‚
â”‚        }                                                â”‚
â”‚      - æ£€æŸ¥æ—¶é—´å†²çªè§„åˆ™                                 â”‚
â”‚      - ä¿å­˜åˆ° sessions è¡¨                               â”‚
â”‚    â†“                                                    â”‚
â”‚    è¿”å›: session                                        â”‚
â”‚                                                         â”‚
â”‚  ã€æäº¤äº‹åŠ¡ã€‘                                            â”‚
â”‚                                                         â”‚
â”‚  Step 4: å‘å¸ƒé¢†åŸŸäº‹ä»¶ï¼ˆäº‹åŠ¡å¤–ï¼‰                         â”‚
â”‚    EventBus.publish(SessionScheduledEvent)              â”‚
â”‚                                                         â”‚
â”‚  è¿”å›: session                                          â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BookingController.createBooking() ç»§ç»­                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  è·å–å…³è”æ•°æ®ï¼ˆç”¨äºè¿”å›ç»™å‰ç«¯ï¼‰:                         â”‚
â”‚    â”œâ”€ ProfileQueryService.getMentorProfile()            â”‚
â”‚    â”œâ”€ BalanceQueryService.getUpdatedBalance()          â”‚
â”‚    â””â”€ ç»„è£…å–æ¶ˆæ”¿ç­–ã€æ“ä½œæç¤ºç­‰                          â”‚
â”‚                                                         â”‚
â”‚  BookingTransformer.toDetailDto()                       â”‚
â”‚  â†“                                                      â”‚
â”‚  ç»„è£…ä¸°å¯Œçš„å“åº”æ•°æ®                                      â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¿”å›ç»™å‰ç«¯:
{
  bookingId: "uuid",
  scheduledAt: "2025-11-10T14:00:00Z",
  duration: 1,
  status: "scheduled",
  statusText: "å·²é¢„çº¦",
  
  mentor: {
    id: "uuid",
    name: "Jane Smith",
    avatar: "https://...",
    company: "Google",
    position: "Senior Engineer"
  },
  
  service: {
    id: "uuid",
    name: "1å¯¹1è¾…å¯¼",
    type: "session"
  },
  
  pricing: {
    cost: 100,
    currency: "USD",
    remainingBalance: 4  // æ›´æ–°åçš„ä½™é¢
  },
  
  actions: {
    canCancel: true,
    cancelDeadline: "2025-11-09T14:00:00Z"  // æå‰24å°æ—¶
  },
  
  hints: {
    nextSteps: [
      "é¢„çº¦å·²ç¡®è®¤",
      "è¯·æå‰5åˆ†é’Ÿå‡†å¤‡",
      "å¦‚éœ€å–æ¶ˆè¯·è‡³å°‘æå‰24å°æ—¶"
    ]
  }
}

é”™è¯¯å¤„ç†ï¼ˆå¦‚æœå¤±è´¥ï¼‰:
- ä½™é¢ä¸è¶³ â†’ è¿”å› 400 + é”™è¯¯ä¿¡æ¯
- æ—¶é—´å†²çª â†’ è¿”å› 409 + å†²çªçš„é¢„çº¦ä¿¡æ¯
- å…¶ä»–é”™è¯¯ â†’ è‡ªåŠ¨å›æ»šäº‹åŠ¡
```

#### é˜¶æ®µ 3: æŸ¥çœ‹æˆ‘çš„é¢„çº¦

```
è¯·æ±‚:
GET /api/bookings/my-bookings?status=scheduled&page=1&limit=10

è°ƒç”¨é“¾:
BookingController.getMyBookings()
  â†“
SessionQueryService.getStudentSessions()
  â†“
æŸ¥è¯¢ sessions è¡¨
  â†“
æ‰¹é‡è·å–å¯¼å¸ˆä¿¡æ¯ï¼ˆé¿å… N+1ï¼‰
ProfileQueryService.getMentorProfiles([mentorIds])
  â†“
BookingTransformer.toListDto()
  â†“
è¿”å›åˆ—è¡¨

è¿”å›ç»™å‰ç«¯:
{
  total: 5,
  page: 1,
  limit: 10,
  items: [
    {
      bookingId: "uuid",
      scheduledAt: "2025-11-10T14:00:00Z",
      duration: 1,
      status: "scheduled",
      mentor: {
        name: "Jane Smith",
        avatar: "https://...",
        company: "Google"
      },
      canJoinNow: false,
      canCancel: true
    },
    // ...
  ]
}
```

---

### æµç¨‹ 4: è¯¾ç¨‹å®Œæˆå’Œè®¡è´¹ â­â­â­ï¼ˆæ ¸å¿ƒæµç¨‹ï¼‰

#### é˜¶æ®µ 1: æ ‡è®°è¯¾ç¨‹å®Œæˆ

```
è¯·æ±‚:
POST /api/bookings/:id/complete
Body: {
  actualDuration: 1.0,  // å®é™…æ—¶é•¿
  notes: "è®¨è®ºäº†ç®€å†ä¼˜åŒ–æ–¹å‘"
}

è°ƒç”¨é“¾:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BookingController.completeSession()                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  è°ƒç”¨ CompletionSaga.execute()  â­â­â­                   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CompletionSaga.execute()                               â”‚
â”‚  (Application Layer)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ã€å¼€å§‹æ•°æ®åº“äº‹åŠ¡ã€‘                                      â”‚
â”‚                                                         â”‚
â”‚  Step 1: æ ‡è®° Session ä¸ºå·²å®Œæˆ â­                       â”‚
â”‚    â†“                                                    â”‚
â”‚    SessionCommandService.completeSession()              â”‚
â”‚    â†“                                                    â”‚
â”‚    Services Domain:                                     â”‚
â”‚      - åŠ è½½ Session å®ä½“                                â”‚
â”‚      - è°ƒç”¨é¢†åŸŸæ–¹æ³•: session.markAsCompleted()          â”‚
â”‚      - éªŒè¯çŠ¶æ€è½¬æ¢è§„åˆ™                                 â”‚
â”‚      - æ›´æ–° sessions è¡¨:                                â”‚
â”‚        {                                                â”‚
â”‚          status: "completed",                           â”‚
â”‚          completedAt: now,                              â”‚
â”‚          actualDuration: 1.0,                           â”‚
â”‚          completionNotes: "..."                         â”‚
â”‚        }                                                â”‚
â”‚    â†“                                                    â”‚
â”‚    è¿”å›: session                                        â”‚
â”‚                                                         â”‚
â”‚  Step 2: æ¶ˆè´¹æœåŠ¡é¢åº¦ â­                                â”‚
â”‚    â†“                                                    â”‚
â”‚    Contract Domain:                                     â”‚
â”‚                                                         â”‚
â”‚    2.1 é‡Šæ”¾é¢„å                                          â”‚
â”‚      - æ›´æ–° service_holds è¡¨:                           â”‚
â”‚        WHERE holdId = session.holdId                    â”‚
â”‚        SET status = 'consumed'                          â”‚
â”‚                                                         â”‚
â”‚    2.2 è®°å½•æœåŠ¡æ¶ˆè´¹æµæ°´                                 â”‚
â”‚      - åˆ›å»º ServiceLedger è®°å½•:                         â”‚
â”‚        {                                                â”‚
â”‚          contractId: "uuid",                            â”‚
â”‚          sessionId: "uuid",                             â”‚
â”‚          serviceId: "uuid",                             â”‚
â”‚          quantity: 1.0,                                 â”‚
â”‚          unitType: "hour",                              â”‚
â”‚          consumedAt: now,                               â”‚
â”‚          ledgerType: "consumption"                      â”‚
â”‚        }                                                â”‚
â”‚      - æ’å…¥åˆ° service_ledgers è¡¨                        â”‚
â”‚      - è¿™æ˜¯å”¯ä¸€äº‹å®æ¥æºï¼                               â”‚
â”‚                                                         â”‚
â”‚    2.3 æ›´æ–°åˆåŒæƒç›Šç¼“å­˜ï¼ˆå¯é€‰ï¼Œç”¨äºæŸ¥è¯¢ä¼˜åŒ–ï¼‰           â”‚
â”‚      - æ›´æ–° contract_entitlements è¡¨:                   â”‚
â”‚        consumedQuantity = consumedQuantity + 1          â”‚
â”‚        remainingQuantity = remainingQuantity - 1        â”‚
â”‚      - ä½¿ç”¨ä¹è§‚é”é˜²æ­¢å¹¶å‘é—®é¢˜                           â”‚
â”‚                                                         â”‚
â”‚  Step 3: è®°å½•åº”ä»˜è´¦æ¬¾ â­                                â”‚
â”‚    â†“                                                    â”‚
â”‚    Finance Domain:                                      â”‚
â”‚      - æŸ¥è¯¢å¯¼å¸ˆè´¹ç‡ï¼ˆä» service_ratesï¼‰                 â”‚
â”‚      - è®¡ç®—åº”ä»˜é‡‘é¢: amount = rate Ã— duration           â”‚
â”‚      - åˆ›å»º APLedger è®°å½•:                              â”‚
â”‚        {                                                â”‚
â”‚          mentorId: "uuid",                              â”‚
â”‚          sessionId: "uuid",                             â”‚
â”‚          amount: 100,                                   â”‚
â”‚          quantity: 1.0,                                 â”‚
â”‚          unitRate: 100,                                 â”‚
â”‚          currency: "USD",                               â”‚
â”‚          ledgerType: "accrual",  // åº”è®¡                â”‚
â”‚          transactionDate: now,                          â”‚
â”‚          status: "pending"  // ç­‰å¾…ç»“ç®—                 â”‚
â”‚        }                                                â”‚
â”‚      - æ’å…¥åˆ° ap_ledgers è¡¨                             â”‚
â”‚      - è¿™æ˜¯å¯¼å¸ˆæŠ¥é…¬çš„è®°å½•ï¼                             â”‚
â”‚                                                         â”‚
â”‚  ã€æäº¤äº‹åŠ¡ã€‘                                            â”‚
â”‚                                                         â”‚
â”‚  Step 4: å‘å¸ƒé¢†åŸŸäº‹ä»¶ï¼ˆäº‹åŠ¡å¤–ï¼‰                         â”‚
â”‚    EventBus.publish(SessionCompletedEvent)              â”‚
â”‚    â†“                                                    â”‚
â”‚    äº‹ä»¶åŒ…å«:                                            â”‚
â”‚    {                                                    â”‚
â”‚      sessionId,                                         â”‚
â”‚      studentId,                                         â”‚
â”‚      mentorId,                                          â”‚
â”‚      serviceId,                                         â”‚
â”‚      duration,                                          â”‚
â”‚      amount,                                            â”‚
â”‚      completedAt                                        â”‚
â”‚    }                                                    â”‚
â”‚                                                         â”‚
â”‚  è¿”å›: { session, billing }                            â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¿”å›ç»™å‰ç«¯:
{
  success: true,
  session: {
    id: "uuid",
    status: "completed",
    completedAt: "2025-11-10T15:00:00Z",
    actualDuration: 1.0
  },
  billing: {
    consumed: 1.0,
    remainingBalance: 4,
    mentorEarning: 100,
    currency: "USD"
  },
  message: "è¯¾ç¨‹å·²å®Œæˆï¼Œå·²æ‰£é™¤ 1 å°æ—¶è¯¾æ—¶"
}
```

#### é˜¶æ®µ 2: æŸ¥çœ‹æˆ‘çš„ä½™é¢

```
è¯·æ±‚:
GET /api/contracts/:id/balance

è°ƒç”¨é“¾:
ContractController.getBalance()
  â†“
BalanceQueryService.getContractBalance()
  â†“
Contract Domain æŸ¥è¯¢:
  - contract_entitlementsï¼ˆåˆ†é…é‡ï¼‰
  - service_ledgersï¼ˆå®é™…æ¶ˆè´¹ï¼Œèšåˆæ±‚å’Œï¼‰
  - service_holdsï¼ˆæ´»è·ƒé¢„å ï¼Œèšåˆæ±‚å’Œï¼‰
  â†“
è®¡ç®—: 
  allocated = 10
  consumed = sum(service_ledgers where contractId) = 4
  held = sum(service_holds where status='active') = 1
  available = allocated - consumed - held = 5
  â†“
è¿”å›:
{
  contractId: "uuid",
  services: [
    {
      serviceId: "uuid",
      serviceName: "1å¯¹1è¾…å¯¼",
      allocated: 10,
      consumed: 4,
      held: 1,
      available: 5,
      unit: "hour"
    }
  ]
}
```

#### é˜¶æ®µ 3: æŸ¥çœ‹å¯¼å¸ˆåº”å¾—æŠ¥é…¬

```
è¯·æ±‚:
GET /api/mentors/me/earnings?startDate=2025-11-01&endDate=2025-11-30

è°ƒç”¨é“¾:
MentorController.getEarnings()
  â†“
FinanceQueryService.getMentorEarnings()
  â†“
Finance Domain æŸ¥è¯¢:
  - ap_ledgers è¡¨
  - WHERE mentorId = current_user
  - WHERE transactionDate BETWEEN start AND end
  - WHERE ledgerType = 'accrual'
  â†“
èšåˆè®¡ç®—
  â†“
è¿”å›:
{
  period: {
    start: "2025-11-01",
    end: "2025-11-30"
  },
  summary: {
    totalSessions: 8,
    totalHours: 8.0,
    totalEarnings: 800,
    currency: "USD",
    pendingSettlement: 800  // MVPé˜¶æ®µéƒ½æ˜¯pending
  },
  details: [
    {
      sessionId: "uuid",
      studentName: "John Doe",
      date: "2025-11-10",
      duration: 1.0,
      amount: 100,
      status: "pending"
    },
    // ...
  ]
}
```

---

## ğŸ“Š æ•°æ®æµå›¾

### é¢„çº¦æµç¨‹æ•°æ®æµ

```
å‰ç«¯
  â†“ POST /api/bookings
API Layer (Controller)
  â†“ è°ƒç”¨
Application Layer (BookingSaga)
  â†“ ç¼–æ’
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Domain Layer æ“ä½œé¡ºåº:              â”‚
â”‚                                     â”‚
â”‚  1. Contract Domain                 â”‚
â”‚     â†’ service_holds è¡¨ (INSERT)     â”‚
â”‚     åˆ›å»ºé¢„å                          â”‚
â”‚                                     â”‚
â”‚  2. Services Domain                 â”‚
â”‚     â†’ sessions è¡¨ (INSERT)          â”‚
â”‚     åˆ›å»ºé¢„çº¦è®°å½•                     â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“ è¿”å›
API Layer (Transformer)
  â†“ ç»„è£…æ•°æ®
å‰ç«¯
```

### å®Œæˆè®¡è´¹æµç¨‹æ•°æ®æµ

```
å‰ç«¯
  â†“ POST /api/bookings/:id/complete
API Layer (Controller)
  â†“ è°ƒç”¨
Application Layer (CompletionSaga)
  â†“ ç¼–æ’
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Domain Layer æ“ä½œé¡ºåº:              â”‚
â”‚                                     â”‚
â”‚  1. Services Domain                 â”‚
â”‚     â†’ sessions è¡¨ (UPDATE)          â”‚
â”‚     æ ‡è®°å®Œæˆ                         â”‚
â”‚                                     â”‚
â”‚  2. Contract Domain                 â”‚
â”‚     â†’ service_holds è¡¨ (UPDATE)     â”‚
â”‚     é‡Šæ”¾é¢„å                          â”‚
â”‚     â†’ service_ledgers è¡¨ (INSERT)   â”‚
â”‚     è®°å½•æ¶ˆè´¹æµæ°´ â­                  â”‚
â”‚     â†’ contract_entitlements (UPDATE)â”‚
â”‚     æ›´æ–°ç¼“å­˜                         â”‚
â”‚                                     â”‚
â”‚  3. Finance Domain                  â”‚
â”‚     â†’ ap_ledgers è¡¨ (INSERT)        â”‚
â”‚     è®°å½•åº”ä»˜è´¦æ¬¾ â­                  â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“ è¿”å›
API Layer (Transformer)
  â†“ ç»„è£…æ•°æ®
å‰ç«¯
```

---

## ğŸ—„ï¸ æ ¸å¿ƒæ•°æ®è¡¨

### è¡¨ 1: usersï¼ˆç”¨æˆ·ï¼‰

```sql
users
â”œâ”€ id (PK)
â”œâ”€ email (UNIQUE)
â”œâ”€ password_hash
â”œâ”€ first_name
â”œâ”€ last_name
â”œâ”€ status (active/inactive)
â””â”€ created_at

user_roles
â”œâ”€ id (PK)
â”œâ”€ user_id (FK â†’ users)
â”œâ”€ role (student/mentor)
â””â”€ is_active
```

### è¡¨ 2: profilesï¼ˆæ¡£æ¡ˆï¼‰

```sql
student_profiles
â”œâ”€ id (PK)
â”œâ”€ user_id (FK â†’ users, UNIQUE)
â”œâ”€ current_school
â”œâ”€ current_major
â”œâ”€ target_degree_level
â””â”€ created_at

mentor_profiles
â”œâ”€ id (PK)
â”œâ”€ user_id (FK â†’ users, UNIQUE)
â”œâ”€ current_company
â”œâ”€ current_position
â”œâ”€ years_of_experience
â”œâ”€ bio
â””â”€ created_at
```

### è¡¨ 3: service_providers & ratesï¼ˆæœåŠ¡æä¾›è€…å’Œè´¹ç‡ï¼‰

```sql
service_providers
â”œâ”€ id (PK)
â”œâ”€ provider_type (internal_mentor)
â”œâ”€ related_id (FK â†’ users)
â”œâ”€ display_name
â”œâ”€ status (active/inactive)
â””â”€ created_at

service_rates â­â­â­
â”œâ”€ id (PK)
â”œâ”€ service_provider_id (FK â†’ service_providers)
â”œâ”€ service_id (FK â†’ services)
â”œâ”€ rate_type (hourly/fixed)
â”œâ”€ base_rate (å¯¼å¸ˆæ¯å°æ—¶è´¹ç‡)
â”œâ”€ currency (USD)
â”œâ”€ is_active
â””â”€ effective_from
```

### è¡¨ 4: servicesï¼ˆæœåŠ¡ç›®å½•ï¼‰

```sql
services
â”œâ”€ id (PK)
â”œâ”€ name ("1å¯¹1è¾…å¯¼")
â”œâ”€ type (session)
â”œâ”€ unit_type (hour)
â”œâ”€ description
â””â”€ is_active
```

### è¡¨ 5: contracts & entitlementsï¼ˆåˆåŒå’Œæƒç›Šï¼‰â­â­â­

```sql
contracts
â”œâ”€ id (PK)
â”œâ”€ student_id (FK â†’ users)
â”œâ”€ total_amount
â”œâ”€ status (active)
â”œâ”€ signed_at
â””â”€ created_at

contract_entitlements â­
â”œâ”€ id (PK)
â”œâ”€ contract_id (FK â†’ contracts)
â”œâ”€ service_id (FK â†’ services)
â”œâ”€ allocated_quantity (è´­ä¹°çš„æ€»é‡ï¼Œå¦‚ 10å°æ—¶)
â”œâ”€ consumed_quantity (å·²æ¶ˆè´¹ï¼Œç¼“å­˜å­—æ®µ)
â”œâ”€ remaining_quantity (å‰©ä½™ï¼Œç¼“å­˜å­—æ®µ)
â””â”€ created_at

UNIQUE(contract_id, service_id)
```

### è¡¨ 6: service_ledgersï¼ˆæœåŠ¡æµæ°´ï¼‰â­â­â­

```sql
service_ledgers (åªèƒ½INSERTï¼Œä¸èƒ½UPDATE/DELETE)
â”œâ”€ id (PK)
â”œâ”€ contract_id (FK â†’ contracts)
â”œâ”€ session_id (FK â†’ sessions)
â”œâ”€ service_id (FK â†’ services)
â”œâ”€ quantity (æ¶ˆè´¹çš„æ•°é‡ï¼Œå¦‚ 1.0å°æ—¶)
â”œâ”€ unit_type (hour)
â”œâ”€ consumed_at
â”œâ”€ ledger_type (consumption/adjustment)
â””â”€ created_at

è¿™æ˜¯æœåŠ¡æ¶ˆè´¹çš„å”¯ä¸€äº‹å®æ¥æºï¼
æ‰€æœ‰æ¶ˆè´¹è®¡ç®—éƒ½ä»è¿™é‡Œèšåˆï¼
```

### è¡¨ 7: service_holdsï¼ˆæœåŠ¡é¢„å ï¼‰â­â­â­

```sql
service_holds
â”œâ”€ id (PK)
â”œâ”€ contract_id (FK â†’ contracts)
â”œâ”€ service_id (FK â†’ services)
â”œâ”€ quantity (é¢„å çš„æ•°é‡ï¼Œå¦‚ 1.0å°æ—¶)
â”œâ”€ status (active/consumed/expired)
â”œâ”€ hold_until (è¿‡æœŸæ—¶é—´ï¼Œå¦‚é¢„çº¦å30åˆ†é’Ÿ)
â””â”€ created_at

é¢„çº¦æ—¶åˆ›å»ºï¼Œå®Œæˆæ—¶æ ‡è®°ä¸ºconsumed
```

### è¡¨ 8: sessionsï¼ˆé¢„çº¦è®°å½•ï¼‰â­â­â­

```sql
sessions
â”œâ”€ id (PK)
â”œâ”€ student_id (FK â†’ users)
â”œâ”€ mentor_id (FK â†’ users)
â”œâ”€ contract_id (FK â†’ contracts)
â”œâ”€ service_id (FK â†’ services)
â”œâ”€ hold_id (FK â†’ service_holds)
â”œâ”€ scheduled_at (é¢„çº¦æ—¶é—´)
â”œâ”€ duration (æ—¶é•¿ï¼Œå¦‚ 1.0å°æ—¶)
â”œâ”€ status (scheduled/completed/cancelled)
â”œâ”€ completed_at
â”œâ”€ actual_duration
â”œâ”€ estimated_cost (é¢„ä¼°è´¹ç”¨)
â”œâ”€ notes
â””â”€ created_at
```

### è¡¨ 9: ap_ledgersï¼ˆåº”ä»˜è´¦æ¬¾ï¼‰â­â­â­

```sql
ap_ledgers (åªèƒ½INSERTï¼Œä¸èƒ½UPDATE/DELETE)
â”œâ”€ id (PK)
â”œâ”€ mentor_id (FK â†’ users)
â”œâ”€ session_id (FK â†’ sessions)
â”œâ”€ amount (åº”ä»˜é‡‘é¢ï¼Œå¦‚ 100)
â”œâ”€ quantity (æœåŠ¡æ•°é‡ï¼Œå¦‚ 1.0å°æ—¶)
â”œâ”€ unit_rate (å•ä»·ï¼Œå¦‚ 100/å°æ—¶)
â”œâ”€ currency (USD)
â”œâ”€ ledger_type (accrual/payment)
â”œâ”€ transaction_date
â”œâ”€ status (pending/settled)
â””â”€ created_at

è¿™æ˜¯å¯¼å¸ˆæŠ¥é…¬çš„å”¯ä¸€äº‹å®æ¥æºï¼
```

---

## ğŸ” æƒé™æ§åˆ¶ï¼ˆç®€åŒ–ï¼‰

### è§’è‰²å®šä¹‰

```
è§’è‰²:
- student: å­¦ç”Ÿ
- mentor: å¯¼å¸ˆ

æƒé™:
- student åªèƒ½:
  - æŸ¥çœ‹è‡ªå·±çš„åˆåŒå’Œä½™é¢
  - é¢„çº¦è¯¾ç¨‹
  - æŸ¥çœ‹è‡ªå·±çš„é¢„çº¦
  
- mentor åªèƒ½:
  - ç®¡ç†è‡ªå·±çš„æ¡£æ¡ˆå’Œè´¹ç‡
  - æŸ¥çœ‹è‡ªå·±çš„é¢„çº¦
  - å®Œæˆè¯¾ç¨‹
  - æŸ¥çœ‹è‡ªå·±çš„æŠ¥é…¬

MVP é˜¶æ®µä½¿ç”¨ç®€å•çš„ Role-Based Access Control (RBAC)
```

---

## ğŸ“… å¼€å‘è®¡åˆ’

### Week 1: åŸºç¡€è®¾æ–½

**ç›®æ ‡**: æ­å»ºé¡¹ç›®æ¡†æ¶

**ä»»åŠ¡**:
- åˆå§‹åŒ– NestJS é¡¹ç›®
- é…ç½® Drizzle ORM
- è®¾è®¡å’Œåˆ›å»ºæ•°æ®åº“è¡¨ç»“æ„
- å®ç° JWT è®¤è¯
- åˆ›å»ºåŸºç¡€çš„ Module ç»“æ„

**äº§å‡º**:
- é¡¹ç›®å¯ä»¥è¿è¡Œ
- æ•°æ®åº“è¡¨åˆ›å»ºå®Œæˆ
- è®¤è¯åŠŸèƒ½å¯ç”¨

**åˆ†å·¥**:
- äººå‘˜1: é¡¹ç›®æ¶æ„ + æ•°æ®åº“è®¾è®¡
- äººå‘˜2: è®¤è¯ç³»ç»Ÿå®ç°
- äººå‘˜3: å‰ç«¯é¡¹ç›®åˆå§‹åŒ–
- äººå‘˜4: å‰åç«¯è”è°ƒå‡†å¤‡

---

### Week 2: ç”¨æˆ·å’Œæ¡£æ¡ˆç®¡ç†

**ç›®æ ‡**: å®Œæˆç”¨æˆ·æ³¨å†Œã€ç™»å½•å’Œæ¡£æ¡ˆç®¡ç†

**åç«¯ä»»åŠ¡**:
- Identity Domain: User å®ä½“å’Œ Repository
- Profile Domain: StudentProfile å’Œ MentorProfile
- Service Provider Domain: ServiceProvider å’Œ ServiceRate
- API: Auth Controller å’Œ Profile Controller
- DTO å’Œ Transformer

**å‰ç«¯ä»»åŠ¡**:
- æ³¨å†Œ/ç™»å½•é¡µé¢
- å­¦ç”Ÿæ¡£æ¡ˆè¡¨å•
- å¯¼å¸ˆæ¡£æ¡ˆè¡¨å•
- å¯¼å¸ˆè´¹ç‡è®¾ç½®

**äº§å‡º**:
- ç”¨æˆ·å¯ä»¥æ³¨å†Œå’Œç™»å½•
- å¯¼å¸ˆå¯ä»¥åˆ›å»ºæ¡£æ¡ˆå’Œè®¾ç½®è´¹ç‡
- å­¦ç”Ÿå¯ä»¥åˆ›å»ºæ¡£æ¡ˆ

**åˆ†å·¥**:
- äººå‘˜1: Domain Layer
- äººå‘˜2: Application + API Layer
- äººå‘˜3: å‰ç«¯é¡µé¢
- äººå‘˜4: å‰ç«¯ API é›†æˆ

---

### Week 3: åˆåŒè´­ä¹°

**ç›®æ ‡**: å­¦ç”Ÿå¯ä»¥è´­ä¹°æœåŠ¡å¥—é¤

**åç«¯ä»»åŠ¡**:
- Contract Domain: Contract å’Œ ContractEntitlement
- Catalog Domain: Serviceï¼ˆé¢„è®¾å‡ ä¸ªæœåŠ¡ï¼‰
- Contract Command Service
- API: Contract Controller
- DTO å’Œ Transformer

**å‰ç«¯ä»»åŠ¡**:
- æœåŠ¡å¥—é¤å±•ç¤ºé¡µ
- è´­ä¹°æµç¨‹é¡µé¢ï¼ˆç®€åŒ–ï¼Œæ ‡è®°ä¸ºå·²æ”¯ä»˜ï¼‰
- æˆ‘çš„åˆåŒé¡µé¢
- ä½™é¢å±•ç¤º

**äº§å‡º**:
- å­¦ç”Ÿå¯ä»¥è´­ä¹°æœåŠ¡å¥—é¤
- å­¦ç”Ÿå¯ä»¥æŸ¥çœ‹è‡ªå·±çš„åˆåŒå’Œä½™é¢

**åˆ†å·¥**:
- äººå‘˜1: Contract Domain + Command Service
- äººå‘˜2: API Layer
- äººå‘˜3: å‰ç«¯è´­ä¹°æµç¨‹
- äººå‘˜4: å‰ç«¯åˆåŒç®¡ç†é¡µé¢

---

### Week 4: é¢„çº¦åŠŸèƒ½ï¼ˆæ ¸å¿ƒï¼‰â­â­â­

**ç›®æ ‡**: å®Œæˆæ ¸å¿ƒé¢„çº¦æµç¨‹

**åç«¯ä»»åŠ¡**:
- Services Domain: Session å®ä½“
- Service Hold åŠŸèƒ½
- Availability Query Service
- Pricing Query Service
- Booking Saga â­
- API: Booking Controller
- Booking Transformer

**å‰ç«¯ä»»åŠ¡**:
- å¯¼å¸ˆåˆ—è¡¨é¡µ
- å¯¼å¸ˆè¯¦æƒ…é¡µ
- é¢„çº¦æ—¥å†é€‰æ‹©
- é¢„çº¦ç¡®è®¤é¡µ
- æˆ‘çš„é¢„çº¦åˆ—è¡¨

**äº§å‡º**:
- å­¦ç”Ÿå¯ä»¥æŸ¥çœ‹å¯¼å¸ˆå’Œè´¹ç‡
- å­¦ç”Ÿå¯ä»¥æŸ¥çœ‹è‡ªå·±çš„ä½™é¢
- å­¦ç”Ÿå¯ä»¥é¢„çº¦è¯¾ç¨‹
- ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºé¢„å 

**åˆ†å·¥**:
- äººå‘˜1: Booking Saga + Domain Logic
- äººå‘˜2: Query Services + API
- äººå‘˜3: å‰ç«¯é¢„çº¦æµç¨‹
- äººå‘˜4: å‰ç«¯é¢„çº¦ç®¡ç†é¡µé¢

---

### Week 5: å®Œæˆå’Œè®¡è´¹åŠŸèƒ½ï¼ˆæ ¸å¿ƒï¼‰â­â­â­

**ç›®æ ‡**: å®Œæˆè¯¾ç¨‹å®Œæˆå’Œè‡ªåŠ¨è®¡è´¹

**åç«¯ä»»åŠ¡**:
- Service Ledger åŠŸèƒ½ â­
- Finance Domain: APLedger
- Completion Saga â­
- Balance Query Service
- Finance Query Service
- äº‹ä»¶å‘å¸ƒ

**å‰ç«¯ä»»åŠ¡**:
- å¯¼å¸ˆï¼šå®Œæˆè¯¾ç¨‹åŠŸèƒ½
- å¯¼å¸ˆï¼šæŸ¥çœ‹æŠ¥é…¬é¡µé¢
- å­¦ç”Ÿï¼šæŸ¥çœ‹æ¶ˆè´¹è®°å½•
- å­¦ç”Ÿï¼šä½™é¢è¯¦æƒ…é¡µ

**äº§å‡º**:
- å¯¼å¸ˆå¯ä»¥æ ‡è®°è¯¾ç¨‹å®Œæˆ
- ç³»ç»Ÿè‡ªåŠ¨æ‰£å‡å­¦ç”Ÿè¯¾æ—¶
- ç³»ç»Ÿè‡ªåŠ¨è®°å½•å¯¼å¸ˆæŠ¥é…¬
- å­¦ç”Ÿå¯ä»¥æŸ¥çœ‹ä½™é¢å˜åŒ–
- å¯¼å¸ˆå¯ä»¥æŸ¥çœ‹åº”å¾—æŠ¥é…¬

**åˆ†å·¥**:
- äººå‘˜1: Completion Saga + Finance Domain
- äººå‘˜2: Service Ledger + Query Services
- äººå‘˜3: å‰ç«¯å¯¼å¸ˆç«¯åŠŸèƒ½
- äººå‘˜4: å‰ç«¯å­¦ç”Ÿç«¯åŠŸèƒ½

---

### Week 6: æµ‹è¯•å’Œä¼˜åŒ–

**ç›®æ ‡**: å®Œæ•´æµ‹è¯•å’Œæ€§èƒ½ä¼˜åŒ–

**ä»»åŠ¡**:
- ç«¯åˆ°ç«¯æµ‹è¯•
- ä¿®å¤ Bug
- æ€§èƒ½ä¼˜åŒ–ï¼ˆæŸ¥è¯¢ã€ç´¢å¼•ï¼‰
- UI/UX ä¼˜åŒ–
- éƒ¨ç½²å‡†å¤‡

**äº§å‡º**:
- åŠŸèƒ½å®Œæ•´å¯ç”¨
- ä¸»è¦ Bug å·²ä¿®å¤
- æ€§èƒ½å¯æ¥å—
- å¯ä»¥éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ

**åˆ†å·¥**:
- å…¨å‘˜: æµ‹è¯•å’Œä¿®å¤
- äººå‘˜1: æ€§èƒ½ä¼˜åŒ–
- äººå‘˜2: éƒ¨ç½²è„šæœ¬
- äººå‘˜3+4: UI/UX ä¼˜åŒ–

---

## âœ… MVP éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

```
å­¦ç”Ÿç«¯:
âœ… å¯ä»¥æ³¨å†Œå’Œç™»å½•
âœ… å¯ä»¥åˆ›å»ºæ¡£æ¡ˆ
âœ… å¯ä»¥è´­ä¹°æœåŠ¡å¥—é¤ï¼ˆè·å¾—è¯¾æ—¶ï¼‰
âœ… å¯ä»¥æŸ¥çœ‹å¯¼å¸ˆåˆ—è¡¨å’Œè´¹ç‡
âœ… å¯ä»¥æŸ¥çœ‹è‡ªå·±çš„ä½™é¢
âœ… å¯ä»¥é¢„çº¦è¯¾ç¨‹
âœ… å¯ä»¥æŸ¥çœ‹è‡ªå·±çš„é¢„çº¦åˆ—è¡¨
âœ… å¯ä»¥æŸ¥çœ‹æ¶ˆè´¹è®°å½•
âœ… ä½™é¢ä¼šåœ¨è¯¾ç¨‹å®Œæˆåè‡ªåŠ¨æ‰£å‡

å¯¼å¸ˆç«¯:
âœ… å¯ä»¥æ³¨å†Œå’Œç™»å½•
âœ… å¯ä»¥åˆ›å»ºæ¡£æ¡ˆ
âœ… å¯ä»¥è®¾ç½®æœåŠ¡è´¹ç‡
âœ… å¯ä»¥æŸ¥çœ‹è‡ªå·±çš„é¢„çº¦åˆ—è¡¨
âœ… å¯ä»¥æ ‡è®°è¯¾ç¨‹å®Œæˆ
âœ… å¯ä»¥æŸ¥çœ‹è‡ªå·±çš„åº”å¾—æŠ¥é…¬

ç³»ç»Ÿ:
âœ… é¢„çº¦æ—¶è‡ªåŠ¨åˆ›å»ºé¢„å ï¼Œé˜²æ­¢è¶…é¢é¢„çº¦
âœ… å®Œæˆè¯¾ç¨‹æ—¶è‡ªåŠ¨ï¼š
   - æ‰£å‡å­¦ç”Ÿè¯¾æ—¶
   - è®°å½•æœåŠ¡æ¶ˆè´¹æµæ°´
   - è®°å½•å¯¼å¸ˆåº”å¾—æŠ¥é…¬
âœ… æ‰€æœ‰è´¢åŠ¡æ•°æ®å¯è¿½æº¯ï¼ˆLedgerï¼‰
```

### éåŠŸèƒ½éªŒæ”¶

```
âœ… å“åº”æ—¶é—´: 
   - æŸ¥è¯¢ < 500ms
   - é¢„çº¦æ“ä½œ < 2s
   
âœ… æ•°æ®ä¸€è‡´æ€§:
   - é¢„çº¦å’Œè®¡è´¹ä½¿ç”¨äº‹åŠ¡
   - Ledger æ•°æ®ä¸å¯ç¯¡æ”¹
   
âœ… å®‰å…¨æ€§:
   - JWT è®¤è¯
   - æƒé™æ§åˆ¶ï¼ˆå­¦ç”Ÿ/å¯¼å¸ˆåªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®ï¼‰
```

---

## ğŸš€ åç»­æ‰©å±•ï¼ˆMVP ä¹‹åï¼‰

### Phase 2: é€šçŸ¥å’Œæé†’

- é¢„çº¦ç¡®è®¤é€šçŸ¥ï¼ˆé‚®ä»¶/çŸ­ä¿¡ï¼‰
- è¯¾ç¨‹å¼€å§‹å‰æé†’
- å¯¼å¸ˆæ—¶é—´å˜æ›´é€šçŸ¥

### Phase 3: æ”¯ä»˜é›†æˆ

- é›†æˆçœŸå®æ”¯ä»˜ç½‘å…³ï¼ˆStripe/PayPalï¼‰
- è‡ªåŠ¨æ”¶æ¬¾
- é€€æ¬¾å¤„ç†

### Phase 4: ç»“ç®—ç³»ç»Ÿ

- å¯¼å¸ˆç»“ç®—ç”³è¯·
- æ‰¹é‡æ‰“æ¬¾
- ç»“ç®—æŠ¥è¡¨

### Phase 5: è§†é¢‘ä¼šè®®

- é›†æˆ Zoom/è…¾è®¯ä¼šè®®
- è‡ªåŠ¨åˆ›å»ºä¼šè®®é“¾æ¥
- ä¼šè®®å½•åƒ

### Phase 6: è¯„ä»·ç³»ç»Ÿ

- å­¦ç”Ÿè¯„ä»·å¯¼å¸ˆ
- å¯¼å¸ˆè¯„åˆ†
- è¯„ä»·å±•ç¤º

### Phase 7: é«˜çº§åŠŸèƒ½

- è¯¾ç¨‹é‡å¤é¢„çº¦
- è¯¾ç¨‹åŒ…ä¼˜æƒ 
- æ¨èç³»ç»Ÿ
- æ•°æ®åˆ†æå’ŒæŠ¥è¡¨

---

## ğŸ“ å…³é”®è®¾è®¡å†³ç­–

### å†³ç­– 1: ä¸ºä»€ä¹ˆéœ€è¦ Service Holdï¼Ÿ

**é—®é¢˜**: é¢„çº¦æ—¶å­¦ç”Ÿè¿˜æœ‰ 5 å°æ—¶ï¼ŒåŒæ—¶é¢„çº¦ 3 æ¬¡è¯¾ï¼Œæ¯æ¬¡ 2 å°æ—¶

**å¦‚æœæ²¡æœ‰ Hold**:
```
æŸ¥è¯¢1: available = 5ï¼Œå…è®¸é¢„çº¦
æŸ¥è¯¢2: available = 5ï¼Œå…è®¸é¢„çº¦ï¼ˆè¿˜æ²¡æ‰£é™¤ï¼ï¼‰
æŸ¥è¯¢3: available = 5ï¼Œå…è®¸é¢„çº¦
ç»“æœ: é¢„çº¦äº† 6 å°æ—¶ï¼Œä½†åªæœ‰ 5 å°æ—¶ä½™é¢ï¼âŒ
```

**æœ‰äº† Hold**:
```
é¢„çº¦1: available = 5 â†’ åˆ›å»º hold(2å°æ—¶) â†’ available = 3
é¢„çº¦2: available = 3 â†’ åˆ›å»º hold(2å°æ—¶) â†’ available = 1
é¢„çº¦3: available = 1 â†’ æ— æ³•é¢„çº¦ 2å°æ—¶ âœ…
```

### å†³ç­– 2: ä¸ºä»€ä¹ˆéœ€è¦ Service Ledgerï¼Ÿ

**ç›®çš„**: å”¯ä¸€äº‹å®æ¥æºï¼ˆSingle Source of Truthï¼‰

**åŸåˆ™**:
- `contract_entitlements.consumed_quantity` æ˜¯ç¼“å­˜ï¼ˆå¯ä»¥é‡å»ºï¼‰
- `service_ledgers` æ˜¯äº‹å®æ¥æºï¼ˆåªèƒ½ Appendï¼‰
- å¦‚æœæ•°æ®ä¸ä¸€è‡´ï¼Œä»¥ Ledger ä¸ºå‡†

**å¥½å¤„**:
- å®Œæ•´çš„å®¡è®¡è½¨è¿¹
- å¯ä»¥å›æº¯ä»»ä½•æ—¶é—´ç‚¹çš„ä½™é¢
- å¯ä»¥ä¿®å¤æ•°æ®ä¸ä¸€è‡´ï¼ˆä» Ledger é‡å»ºï¼‰

### å†³ç­– 3: ä¸ºä»€ä¹ˆè¯¾ç¨‹å®Œæˆæ—¶æ‰è®¡è´¹ï¼Ÿ

**åŸå› **:
- å­¦ç”Ÿå¯èƒ½å–æ¶ˆé¢„çº¦
- è¯¾ç¨‹å¯èƒ½æ”¹æœŸ
- å®é™…æ—¶é•¿å¯èƒ½ä¸é¢„çº¦ä¸åŒ

**æµç¨‹**:
```
é¢„çº¦æ—¶: åˆ›å»º Holdï¼ˆé”å®šé¢åº¦ï¼‰
å®Œæˆæ—¶: 
  - é‡Šæ”¾ Hold
  - è®°å½• Service Ledgerï¼ˆæ¶ˆè´¹ï¼‰
  - è®°å½• AP Ledgerï¼ˆå¯¼å¸ˆæŠ¥é…¬ï¼‰
```

### å†³ç­– 4: ä¸ºä»€ä¹ˆ Ledger ä¸èƒ½ä¿®æ”¹ï¼Ÿ

**åŸå› **: å®¡è®¡å’Œåˆè§„è¦æ±‚

**å¦‚æœéœ€è¦ä¿®æ”¹**:
```
ä¸è¦ UPDATE æˆ– DELETE
è€Œæ˜¯ INSERT æ–°çš„è°ƒæ•´è®°å½•

ä¾‹å¦‚ï¼šé€€æ¬¾
- ä¸åˆ é™¤åŸå§‹æ¶ˆè´¹è®°å½•
- æ–°å¢ä¸€æ¡ adjustment è®°å½•ï¼ˆè´Ÿæ•°ï¼‰
- æœ€ç»ˆä½™é¢ = sum(æ‰€æœ‰è®°å½•)
```

---

## ğŸ¯ æˆåŠŸæŒ‡æ ‡

### æŠ€æœ¯æŒ‡æ ‡

```
âœ… ä»£ç è¦†ç›–ç‡ > 70%ï¼ˆåç»­æ·»åŠ æµ‹è¯•ï¼‰
âœ… API å“åº”æ—¶é—´ < 500ms
âœ… æ•°æ®åº“æŸ¥è¯¢ < 100ms
âœ… é›¶æ•°æ®ä¸ä¸€è‡´é—®é¢˜
```

### ä¸šåŠ¡æŒ‡æ ‡

```
âœ… å­¦ç”Ÿå¯ä»¥ç‹¬ç«‹å®Œæˆé¢„çº¦æµç¨‹
âœ… å¯¼å¸ˆå¯ä»¥æŸ¥çœ‹è‡ªå·±çš„æŠ¥é…¬
âœ… ç³»ç»Ÿè‡ªåŠ¨è®¡è´¹æ— éœ€äººå·¥å¹²é¢„
âœ… è´¢åŠ¡æ•°æ®å¯è¿½æº¯å’Œå¯¹è´¦
```

---

**MVP è®¡åˆ’ç»“æŸ**

è¿™æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„ã€èšç„¦æ ¸å¿ƒåŠŸèƒ½çš„ MVP è®¡åˆ’ï¼Œé¢„è®¡ 4-6 å‘¨å®Œæˆã€‚
é‡ç‚¹æ˜¯éªŒè¯"å­¦ç”Ÿçº¦è¯¾+è‡ªåŠ¨è®¡è´¹"çš„æ ¸å¿ƒä»·å€¼ï¼ğŸš€
